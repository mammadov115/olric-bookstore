{% extends 'base.html' %}

{% block title %}Ana Səhifə | Olric Bookstore{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-secondary text-white rounded-[2.5rem] overflow-hidden shadow-2xl mb-16 relative animate-fade-in group">
    <!-- Premium Gradient Overlay -->
    <div class="absolute inset-0 bg-gradient-to-br from-secondary via-secondary/90 to-primary/10"></div>
    
    <div class="px-8 py-12 md:py-24 flex flex-col md:flex-row items-center relative z-10 gap-12">
        <div class="md:w-1/2 text-center md:text-left">
            <div class="inline-block px-4 py-1.5 rounded-full bg-white/10 backdrop-blur-md border border-white/20 text-white text-[10px] font-black uppercase tracking-widest mb-6">
                Açılışa Özəl: Bütün Kitablara 20% Endirim!
            </div>
            <h1 class="text-4xl md:text-7xl font-black text-white mb-6 leading-[1.1] tracking-tight">
                Kitabların <span class="text-primary italic">Sehrli</span> Dünyasına Xoş Gəldiniz
            </h1>
            <p class="text-white/70 text-base md:text-xl mb-10 max-w-lg mx-auto md:mx-0 leading-relaxed">
                Minlərlə kitab, onlarla janr və ən sevdiyiniz yazıçılar bir ünvanda. Olric ilə mütaliə daha maraqlıdır. 
            </p>
            <div class="flex flex-col sm:flex-row gap-5 justify-center md:justify-start">
                <a href="{% url 'books:book_list' %}" class="btn btn-primary px-10 py-5 text-base shadow-2xl hover:-translate-y-1 transition-all">
                    İndi Alış-veriş Et
                </a>
                <a href="{% url 'books:book_list' %}" class="btn bg-white/10 backdrop-blur-md text-white border border-white/20 px-10 py-5 text-base hover:bg-white hover:text-secondary transition-all shadow-xl">
                    Yeni Gələnlər
                </a>
            </div>
        </div>
        <div class="md:w-1/2 flex justify-center relative">
            <!-- Floating Decorative Elements -->
            <div class="absolute -top-10 -right-10 w-32 h-32 bg-primary/20 rounded-full blur-3xl animate-pulse"></div>
            
            <div class="relative scale-90 md:scale-100 transition-all duration-700 group-hover:scale-105">
                <!-- Stacked Books Effect -->
                <div class="w-56 h-72 md:w-72 md:h-96 bg-white rounded-3xl shadow-2xl transform rotate-6 border-4 border-white transition-transform group-hover:rotate-0 duration-700 overflow-hidden relative z-20">
                    <img src="https://images.unsplash.com/photo-1544947950-fa07a98d237f?auto=format&fit=crop&q=80&w=800" alt="Featured Book" class="w-full h-full object-cover">
                </div>
                <!-- Background shadow/depth cards -->
                <div class="w-56 h-72 md:w-72 md:h-96 bg-primary/30 rounded-3xl shadow-xl absolute top-4 left-4 -rotate-3 z-10 backdrop-blur-sm transition-transform duration-700 group-hover:rotate-6 group-hover:left-8"></div>
                <div class="w-56 h-72 md:w-72 md:h-96 bg-secondary/20 rounded-3xl shadow-xl absolute -bottom-4 -left-4 -rotate-12 z-0 backdrop-blur-md transition-transform duration-700 group-hover:-rotate-6 group-hover:-bottom-8 group-hover:-left-8"></div>
            </div>
        </div>
    </div>
    
    <!-- Abstract Background Art -->
    <div class="absolute top-0 right-0 -mt-20 -mr-20 w-80 md:w-[30rem] h-80 md:h-[30rem] bg-primary opacity-20 rounded-full blur-[100px] pointer-events-none"></div>
    <div class="absolute bottom-0 left-0 -mb-20 -ml-20 w-80 md:w-[30rem] h-80 md:h-[30rem] bg-primary opacity-10 rounded-full blur-[100px] pointer-events-none"></div>
</section>

<!-- Categories Section -->
<section class="mb-24 px-4 md:px-0">
    <div class="flex justify-between items-end mb-10">
        <div>
            <p class="text-[10px] font-black text-primary uppercase tracking-[0.2em] mb-2">Geniş Seçim</p>
            <h2 class="text-3xl md:text-4xl font-black text-secondary">Kateqoriyalar</h2>
        </div>
        <a href="{% url 'books:category_list' %}" class="group text-secondary font-black hover:text-primary transition-all text-sm md:text-base flex items-center gap-2">
            Hamısına bax 
            <span class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center group-hover:bg-primary group-hover:text-white transition-all">
                <i class="fas fa-arrow-right text-xs"></i>
            </span>
        </a>
    </div>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 md:gap-6">
        {% for cat in categories %}
        <a href="{% url 'books:category_books' cat.slug %}" class="group relative bg-white p-8 rounded-[2rem] border border-gray-100 shadow-sm hover:shadow-2xl hover:-translate-y-2 transition-all duration-500 overflow-hidden">
            <!-- Decorative circle -->
            <div class="absolute -top-10 -right-10 w-24 h-24 bg-gray-50 rounded-full group-hover:bg-primary/10 transition-colors duration-500"></div>
            
            <div class="relative z-10 flex flex-col items-center">
                <div class="w-16 h-16 bg-gray-50 rounded-2xl flex items-center justify-center mb-6 group-hover:bg-primary group-hover:text-white transition-all duration-500 text-secondary text-2xl shadow-inner group-hover:shadow-lg group-hover:rotate-6">
                    <i class="fas fa-bookmark"></i>
                </div>
                <h3 class="font-black text-secondary text-sm md:text-base mb-1 text-center group-hover:text-primary transition-colors">{{ cat.name }}</h3>
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">{{ cat.books.count }} kitab</p>
            </div>
        </a>
        {% empty %}
        <div class="col-span-full py-12 text-center bg-gray-50 rounded-[2rem] border-2 border-dashed border-gray-200">
             <i class="fas fa-layer-group text-4xl text-gray-300 mb-4 pill-shadow"></i>
             <p class="text-sm font-black text-gray-400 uppercase tracking-widest">Hələ ki, kateqoriya yoxdur</p>
        </div>
        {% endfor %}
    </div>
</section>

<!-- Featured Books Section -->
<section class="mb-24 px-4 md:px-0" id="featured">
    <div class="flex flex-col md:flex-row md:items-end justify-between mb-12 gap-6">
        <div>
            <p class="text-[10px] font-black text-primary uppercase tracking-[0.2em] mb-2">Sizin Üçün Seçilənlər</p>
            <h2 class="text-3xl md:text-5xl font-black text-secondary">Ən çox satılanlar</h2>
        </div>
        <div class="flex items-center gap-4">
            <div class="flex p-1.5 bg-gray-100 rounded-2xl">
                <button class="px-6 py-2.5 rounded-xl bg-white shadow-sm text-xs font-black text-secondary uppercase tracking-widest">Hər şey</button>
                <button class="px-6 py-2.5 rounded-xl text-xs font-black text-gray-400 uppercase tracking-widest hover:text-secondary transition-colors">Bədii</button>
                <button class="px-6 py-2.5 rounded-xl text-xs font-black text-gray-400 uppercase tracking-widest hover:text-secondary transition-colors">Biznes</button>
            </div>
        </div>
    </div>
    
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-6 md:gap-10">
        {% for book in featured_books %}
        <div class="group relative bg-white p-4 rounded-[2.5rem] border border-gray-100 shadow-sm hover:shadow-2xl transition-all duration-500 flex flex-col h-full">
            <!-- Book Image Wrap -->
            <div class="relative aspect-[3/4] rounded-[2rem] overflow-hidden mb-6 shadow-inner bg-gray-50">
                {% if book.cover_image %}
                <img src="{{ book.cover_image.url }}" alt="{{ book.title }}" class="w-full h-full object-cover group-hover:scale-110 group-hover:rotate-2 transition-all duration-700">
                {% else %}
                <div class="w-full h-full flex items-center justify-center text-gray-200">
                    <i class="fas fa-book text-5xl"></i>
                </div>
                {% endif %}
                
                <!-- Hover Overlay -->
                <div class="absolute inset-0 bg-secondary/40 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-all duration-500 flex items-center justify-center gap-3">
                    <button class="w-12 h-12 bg-white rounded-2xl shadow-xl text-red-500 hover:bg-red-500 hover:text-white transition-all transform translate-y-4 group-hover:translate-y-0 delay-75">
                        <i class="far fa-heart text-lg"></i>
                    </button>
                    <a href="{{ book.get_absolute_url }}" class="w-12 h-12 bg-white rounded-2xl shadow-xl text-secondary hover:bg-secondary hover:text-white transition-all transform translate-y-4 group-hover:translate-y-0 delay-150 flex items-center justify-center">
                        <i class="fas fa-eye text-lg"></i>
                    </a>
                </div>

                {% if book.discount_price %}
                <div class="absolute top-4 left-4 bg-primary text-white px-4 py-2 rounded-xl text-[10px] font-black shadow-lg shadow-primary/20 z-10">
                    -{{ book.discount_percent|default:"ENDIRIM" }}%
                </div>
                {% endif %}
            </div>

            <!-- Content -->
            <div class="px-2 pb-2 flex flex-col flex-grow">
                <p class="text-[10px] font-black text-primary uppercase tracking-[0.2em] mb-1 leading-none">{{ book.categories.first.name|default:"Kitab" }}</p>
                
                <div class="flex items-center gap-1 mb-2">
                    <div class="flex text-yellow-400 text-[10px]">
                        {% with rating=book.avg_rating %}
                        <i class="{% if rating >= 1 %}fas{% elif rating >= 0.5 %}fas fa-star-half-alt{% else %}far{% endif %} fa-star"></i>
                        <i class="{% if rating >= 2 %}fas{% elif rating >= 1.5 %}fas fa-star-half-alt{% else %}far{% endif %} fa-star"></i>
                        <i class="{% if rating >= 3 %}fas{% elif rating >= 2.5 %}fas fa-star-half-alt{% else %}far{% endif %} fa-star"></i>
                        <i class="{% if rating >= 4 %}fas{% elif rating >= 3.5 %}fas fa-star-half-alt{% else %}far{% endif %} fa-star"></i>
                        <i class="{% if rating >= 5 %}fas{% elif rating >= 4.5 %}fas fa-star-half-alt{% else %}far{% endif %} fa-star"></i>
                        {% endwith %}
                    </div>
                    {% if book.review_count > 0 %}
                    <span class="text-[9px] text-gray-400 font-bold">({{ book.avg_rating|floatformat:1 }})</span>
                    {% endif %}
                </div>

                <h3 class="font-black text-secondary text-base md:text-lg mb-2 line-clamp-2 leading-tight group-hover:text-primary transition-colors">
                    <a href="{{ book.get_absolute_url }}">{{ book.title }}</a>
                </h3>
                <p class="text-xs font-bold text-gray-400 mb-6 leading-none">{{ book.authors.first.name }}</p>
                
                <div class="mt-auto flex items-center justify-between gap-4">
                    <div class="flex flex-col">
                        <span class="text-2xl font-black text-secondary tracking-tight">{{ book.final_price }} <span class="text-sm font-bold opacity-50">AZN</span></span>
                        {% if book.discount_price %}
                        <span class="text-xs text-gray-300 line-through font-bold">{{ book.price }} AZN</span>
                        {% endif %}
                    </div>
                    <button class="add-to-cart w-14 h-14 bg-secondary text-white rounded-2xl hover:bg-primary transition-all duration-300 shadow-xl shadow-secondary/10 flex items-center justify-center group-hover:scale-105 active:scale-95" 
                            data-url="{% url 'cart:cart_add' book.id %}" 
                            data-qty="1">
                        <i class="fas fa-shopping-basket"></i>
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}
